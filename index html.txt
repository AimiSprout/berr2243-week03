<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        h1 { color: #333; }
        input, button { margin: 5px; padding: 5px; }
        table { border-collapse: collapse; margin-top: 20px; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f4f4f4; }
    </style>
</head>
<body>
    <h1>User Dashboard</h1>

    <h3>Create User</h3>
    <input id="name" placeholder="Name">
    <input id="email" placeholder="Email">
    <button onclick="createUser()">Create</button>

    <h3>Update User</h3>
    <input id="updateId" placeholder="User ID">
    <input id="updateName" placeholder="New Name">
    <input id="updateEmail" placeholder="New Email">
    <button onclick="updateUser()">Update</button>

    <h3>Delete User</h3>
    <input id="deleteId" placeholder="User ID">
    <button onclick="deleteUser()">Delete</button>

    <h3>All Users</h3>
    <button onclick="fetchUsers()">Refresh</button>
    <table id="userTable">
        <thead>
            <tr><th>ID</th><th>Name</th><th>Email</th></tr>
        </thead>
        <tbody></tbody>
    </table>

    <script>
        const apiUrl = 'http://localhost:3000/users';

        async function fetchUsers() {
            const res = await fetch(apiUrl);
            const data = await res.json();
            const tbody = document.querySelector('#userTable tbody');
            tbody.innerHTML = '';
            data.forEach(user => {
                const row = `<tr><td>${user._id}</td><td>${user.name || '-'}</td><td>${user.email || '-'}</td></tr>`;
                tbody.innerHTML += row;
            });
        }

        async function createUser() {
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const res = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, email })
            });
            alert("User created!");
            fetchUsers();
        }

        async function updateUser() {
            const id = document.getElementById('updateId').value;
            const name = document.getElementById('updateName').value;
            const email = document.getElementById('updateEmail').value;
            const res = await fetch(`${apiUrl}/${id}`, {
                method: 'PATCH',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, email })
            });
            alert("User updated!");
            fetchUsers();
        }

        async function deleteUser() {
            const id = document.getElementById('deleteId').value;
            const res = await fetch(`${apiUrl}/${id}`, {
                method: 'DELETE'
            });
            alert("User deleted!");
            fetchUsers();
        }

        fetchUsers(); // Load users on start
    </script>
</body>
</html>
